{"version":3,"file":"VerificationCodeAuthenticator.js","names":["VerificationCodeAuthenticator","Authenticator","canVerify","values","credentials","verificationCode","otp","mapCredentials","passcode","getInputs","idxRemediationValue","form","value","name","type","required"],"sources":["../../../../lib/idx/authenticator/VerificationCodeAuthenticator.ts"],"sourcesContent":["import { Authenticator, Credentials } from './Authenticator';\n\nexport interface VerificationCodeValues {\n  verificationCode?: string;\n  otp?: string;\n  credentials?: Credentials;\n}\n\ninterface VerificationCodeCredentials extends Credentials {\n  passcode: string;\n}\n\n// general authenticator to handle \"verificationCode\" input\n// it can be used for \"email\", \"phone\", \"google authenticator\"\n// a new authenticator class should be created if special cases need to be handled\nexport class VerificationCodeAuthenticator extends Authenticator<VerificationCodeValues> {\n  canVerify(values: VerificationCodeValues) {\n    return !!(values.credentials ||values.verificationCode || values.otp);\n  }\n\n  mapCredentials(values): VerificationCodeCredentials | Credentials | undefined {\n    const { credentials, verificationCode, otp } = values;\n    if (!credentials && !verificationCode && !otp) {\n      return;\n    }\n    return credentials || { passcode: verificationCode || otp };\n  }\n\n  getInputs(idxRemediationValue) {\n    return {\n      ...idxRemediationValue.form?.value[0],\n      name: 'verificationCode',\n      type: 'string',\n      required: idxRemediationValue.required\n    };\n  }\n}\n"],"mappings":";;;AAAA;AAYA;AACA;AACA;AACO,MAAMA,6BAA6B,SAASC,4BAAa,CAAyB;EACvFC,SAAS,CAACC,MAA8B,EAAE;IACxC,OAAO,CAAC,EAAEA,MAAM,CAACC,WAAW,IAAGD,MAAM,CAACE,gBAAgB,IAAIF,MAAM,CAACG,GAAG,CAAC;EACvE;EAEAC,cAAc,CAACJ,MAAM,EAAyD;IAC5E,MAAM;MAAEC,WAAW;MAAEC,gBAAgB;MAAEC;IAAI,CAAC,GAAGH,MAAM;IACrD,IAAI,CAACC,WAAW,IAAI,CAACC,gBAAgB,IAAI,CAACC,GAAG,EAAE;MAC7C;IACF;IACA,OAAOF,WAAW,IAAI;MAAEI,QAAQ,EAAEH,gBAAgB,IAAIC;IAAI,CAAC;EAC7D;EAEAG,SAAS,CAACC,mBAAmB,EAAE;IAAA;IAC7B,OAAO;MACL,6BAAGA,mBAAmB,CAACC,IAAI,0DAAxB,sBAA0BC,KAAK,CAAC,CAAC,CAAC;MACrCC,IAAI,EAAE,kBAAkB;MACxBC,IAAI,EAAE,QAAQ;MACdC,QAAQ,EAAEL,mBAAmB,CAACK;IAChC,CAAC;EACH;AACF;AAAC"}