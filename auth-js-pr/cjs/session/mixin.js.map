{"version":3,"file":"mixin.js","names":["mixinSession","Base","OktaAuthSession","constructor","args","session","createSessionApi","closeSession","close","then","clearStorage","catch","e","name","errorCode"],"sources":["../../../lib/session/mixin.ts"],"sourcesContent":["import { OktaAuthHttpInterface, OktaAuthHttpOptions } from '../http/types';\nimport { OktaAuthConstructor } from '../base/types';\nimport { createSessionApi } from './factory';\nimport {\n  OktaAuthSessionInterface, SessionAPI,\n} from './types';\nimport { StorageManagerInterface } from '../storage/types';\n\nexport function mixinSession\n<\n  S extends StorageManagerInterface = StorageManagerInterface,\n  O extends OktaAuthHttpOptions = OktaAuthHttpOptions,\n  TBase extends OktaAuthConstructor<OktaAuthHttpInterface<S, O>>\n    = OktaAuthConstructor<OktaAuthHttpInterface<S, O>>\n>\n(Base: TBase): TBase & OktaAuthConstructor<OktaAuthSessionInterface<S, O>>\n{\n  return class OktaAuthSession extends Base implements OktaAuthSessionInterface<S, O>\n  {\n    session: SessionAPI;\n\n    constructor(...args: any[]) {\n      super(...args);\n\n      this.session = createSessionApi(this);\n    }\n\n    // Ends the current Okta SSO session without redirecting to Okta.\n    closeSession(): Promise<boolean> {\n      return this.session.close() // DELETE /api/v1/sessions/me\n      .then(async () => {\n        // Clear all local tokens\n        this.clearStorage();\n        return true;\n      })\n      .catch(function(e) {\n        if (e.name === 'AuthApiError' && e.errorCode === 'E0000007') {\n          // Session does not exist or has already been closed\n          return false;\n        }\n        throw e;\n      });\n    }\n  };\n}\n"],"mappings":";;;AAEA;AAMO,SAASA,YAAY,CAO3BC,IAAW,EACZ;EACE,OAAO,MAAMC,eAAe,SAASD,IAAI,CACzC;IAGEE,WAAW,CAAC,GAAGC,IAAW,EAAE;MAC1B,KAAK,CAAC,GAAGA,IAAI,CAAC;MAEd,IAAI,CAACC,OAAO,GAAG,IAAAC,yBAAgB,EAAC,IAAI,CAAC;IACvC;;IAEA;IACAC,YAAY,GAAqB;MAC/B,OAAO,IAAI,CAACF,OAAO,CAACG,KAAK,EAAE,CAAC;MAAA,CAC3BC,IAAI,CAAC,YAAY;QAChB;QACA,IAAI,CAACC,YAAY,EAAE;QACnB,OAAO,IAAI;MACb,CAAC,CAAC,CACDC,KAAK,CAAC,UAASC,CAAC,EAAE;QACjB,IAAIA,CAAC,CAACC,IAAI,KAAK,cAAc,IAAID,CAAC,CAACE,SAAS,KAAK,UAAU,EAAE;UAC3D;UACA,OAAO,KAAK;QACd;QACA,MAAMF,CAAC;MACT,CAAC,CAAC;IACJ;EACF,CAAC;AACH"}