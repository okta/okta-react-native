{"version":3,"file":"validateToken.js","names":["validateToken","token","type","isIDToken","isAccessToken","isRefreshToken","AuthSdkError"],"sources":["../../../../lib/oidc/util/validateToken.ts"],"sourcesContent":["/* eslint-disable complexity */\n\nimport { AuthSdkError } from '../../errors';\nimport { isAccessToken, isIDToken, isRefreshToken, Token, TokenType } from '../../oidc/types';\n\nexport function validateToken(token: Token, type?: TokenType) {\n  if (!isIDToken(token) && !isAccessToken(token) && !isRefreshToken(token)) {\n    throw new AuthSdkError(\n      'Token must be an Object with scopes, expiresAt, and one of: an idToken, accessToken, or refreshToken property'\n    );\n  }\n  \n  if (type === 'accessToken' && !isAccessToken(token)) {\n    throw new AuthSdkError('invalid accessToken');\n  } \n  if (type === 'idToken' && !isIDToken(token)) {\n    throw new AuthSdkError('invalid idToken');\n  }\n\n  if (type === 'refreshToken' && !isRefreshToken(token)) {\n    throw new AuthSdkError('invalid refreshToken');\n  }\n}"],"mappings":";;;AAEA;AACA;AAHA;;AAKO,SAASA,aAAa,CAACC,KAAY,EAAEC,IAAgB,EAAE;EAC5D,IAAI,CAAC,IAAAC,gBAAS,EAACF,KAAK,CAAC,IAAI,CAAC,IAAAG,oBAAa,EAACH,KAAK,CAAC,IAAI,CAAC,IAAAI,qBAAc,EAACJ,KAAK,CAAC,EAAE;IACxE,MAAM,IAAIK,oBAAY,CACpB,+GAA+G,CAChH;EACH;EAEA,IAAIJ,IAAI,KAAK,aAAa,IAAI,CAAC,IAAAE,oBAAa,EAACH,KAAK,CAAC,EAAE;IACnD,MAAM,IAAIK,oBAAY,CAAC,qBAAqB,CAAC;EAC/C;EACA,IAAIJ,IAAI,KAAK,SAAS,IAAI,CAAC,IAAAC,gBAAS,EAACF,KAAK,CAAC,EAAE;IAC3C,MAAM,IAAIK,oBAAY,CAAC,iBAAiB,CAAC;EAC3C;EAEA,IAAIJ,IAAI,KAAK,cAAc,IAAI,CAAC,IAAAG,qBAAc,EAACJ,KAAK,CAAC,EAAE;IACrD,MAAM,IAAIK,oBAAY,CAAC,sBAAsB,CAAC;EAChD;AACF"}