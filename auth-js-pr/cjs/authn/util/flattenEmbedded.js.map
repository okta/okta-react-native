{"version":3,"file":"flattenEmbedded.js","names":["flattenEmbedded","sdk","tx","res","obj","ref","clone","Array","isArray","objArr","o","ol","length","push","embedded","_embedded","key","Object","prototype","hasOwnProperty","call","isObject","fns","links2fns","assign","omit"],"sources":["../../../../lib/authn/util/flattenEmbedded.ts"],"sourcesContent":["/* eslint-disable complexity */\nimport { OktaAuthHttpInterface } from '../../http/types';\nimport { clone, isObject, omit } from '../../util';\nimport { AuthnTransactionAPI } from '../types';\nimport { links2fns } from './links2fns';\n\nexport function flattenEmbedded(sdk: OktaAuthHttpInterface, tx: AuthnTransactionAPI, res, obj, ref) {\n  obj = obj || res;\n  obj = clone(obj);\n\n  if (Array.isArray(obj)) {\n    var objArr = [];\n    for (var o = 0, ol = obj.length; o < ol; o++) {\n      objArr.push(flattenEmbedded(sdk, tx, res, obj[o], ref) as never);\n    }\n    return objArr;\n  }\n\n  var embedded = obj._embedded || {};\n\n  for (var key in embedded) {\n    if (!Object.prototype.hasOwnProperty.call(embedded, key)) {\n      continue;\n    }\n\n    // Flatten any nested _embedded objects\n    if (isObject(embedded[key]) || Array.isArray(embedded[key])) {\n      embedded[key] = flattenEmbedded(sdk, tx, res, embedded[key], ref);\n    }\n  }\n\n  // Convert any links on the embedded object\n  var fns = links2fns(sdk, tx, res, obj, ref);\n  Object.assign(embedded, fns);\n\n  obj = omit(obj, '_embedded', '_links');\n  Object.assign(obj, embedded);\n  return obj;\n}\n"],"mappings":";;;AAEA;AAEA;AAJA;;AAMO,SAASA,eAAe,CAACC,GAA0B,EAAEC,EAAuB,EAAEC,GAAG,EAAEC,GAAG,EAAEC,GAAG,EAAE;EAClGD,GAAG,GAAGA,GAAG,IAAID,GAAG;EAChBC,GAAG,GAAG,IAAAE,WAAK,EAACF,GAAG,CAAC;EAEhB,IAAIG,KAAK,CAACC,OAAO,CAACJ,GAAG,CAAC,EAAE;IACtB,IAAIK,MAAM,GAAG,EAAE;IACf,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEC,EAAE,GAAGP,GAAG,CAACQ,MAAM,EAAEF,CAAC,GAAGC,EAAE,EAAED,CAAC,EAAE,EAAE;MAC5CD,MAAM,CAACI,IAAI,CAACb,eAAe,CAACC,GAAG,EAAEC,EAAE,EAAEC,GAAG,EAAEC,GAAG,CAACM,CAAC,CAAC,EAAEL,GAAG,CAAC,CAAU;IAClE;IACA,OAAOI,MAAM;EACf;EAEA,IAAIK,QAAQ,GAAGV,GAAG,CAACW,SAAS,IAAI,CAAC,CAAC;EAElC,KAAK,IAAIC,GAAG,IAAIF,QAAQ,EAAE;IACxB,IAAI,CAACG,MAAM,CAACC,SAAS,CAACC,cAAc,CAACC,IAAI,CAACN,QAAQ,EAAEE,GAAG,CAAC,EAAE;MACxD;IACF;;IAEA;IACA,IAAI,IAAAK,cAAQ,EAACP,QAAQ,CAACE,GAAG,CAAC,CAAC,IAAIT,KAAK,CAACC,OAAO,CAACM,QAAQ,CAACE,GAAG,CAAC,CAAC,EAAE;MAC3DF,QAAQ,CAACE,GAAG,CAAC,GAAGhB,eAAe,CAACC,GAAG,EAAEC,EAAE,EAAEC,GAAG,EAAEW,QAAQ,CAACE,GAAG,CAAC,EAAEX,GAAG,CAAC;IACnE;EACF;;EAEA;EACA,IAAIiB,GAAG,GAAG,IAAAC,oBAAS,EAACtB,GAAG,EAAEC,EAAE,EAAEC,GAAG,EAAEC,GAAG,EAAEC,GAAG,CAAC;EAC3CY,MAAM,CAACO,MAAM,CAACV,QAAQ,EAAEQ,GAAG,CAAC;EAE5BlB,GAAG,GAAG,IAAAqB,UAAI,EAACrB,GAAG,EAAE,WAAW,EAAE,QAAQ,CAAC;EACtCa,MAAM,CAACO,MAAM,CAACpB,GAAG,EAAEU,QAAQ,CAAC;EAC5B,OAAOV,GAAG;AACZ"}